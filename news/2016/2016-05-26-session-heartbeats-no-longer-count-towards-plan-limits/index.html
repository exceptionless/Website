<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

    <title>Session Heartbeats No Longer Count Towards Plan Limits - Exceptionless</title>

    <meta name="description" content="Real-time exception reporting for ASP.NET, Web API, WebForms, WPF, Console, and MVC applications. Includes event organization, notifications, and more.">
    <meta name="robots" content="index,follow">
    <meta name="author" content="[object Object]">

    <link rel="canonical" href="NaN">

    <!-- opengraph -->
    <meta property="og:title" content="Session Heartbeats No Longer Count Towards Plan Limits - Exceptionless">
    <meta property="og:type" content="article">
    <meta property="og:url" content="NaN">
    <meta property="og:description" content="Real-time exception reporting for ASP.NET, Web API, WebForms, WPF, Console, and MVC applications. Includes event organization, notifications, and more.">
    <meta property="og:image" content="undefined/undefined/undefined">
    <!-- end opengraph -->

    <!-- twitter -->
    <meta name="twitter:card" content="summary"><meta name="twitter:site" content="@Exceptionless">
    <meta name="twitter:url" content="NaN">
    <meta name="twitter:title" content="Session Heartbeats No Longer Count Towards Plan Limits - Exceptionless">
    <meta name="twitter:description" content="Real-time exception reporting for ASP.NET, Web API, WebForms, WPF, Console, and MVC applications. Includes event organization, notifications, and more.">
    <meta name="twitter:image" content="undefined/undefined/undefined">
    <!-- end twitter -->

    <!-- google tag manager -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-433340-8"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-433340-8');
    </script>
    <!-- end google tag manager -->

    <link rel="alternate" href="/website/feed.xml" type="application/atom+xml" title="Exceptionless">
    <link rel="alternate" href="/website/feed.json" type="application/json" title="Exceptionless">
    <link rel="shortcut icon" href="/website/favicon.ico">

    <link rel="stylesheet" href="/website/assets/cyclone-slider-pro/templates/standard/style.css">
    <link rel="stylesheet" href="/website/assets/css/theme.css">
    <link rel="stylesheet" href="/website/assets/css/responsive.css">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,300,400,600" rel="stylesheet">

    <link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <link href="/website/assets/css/prism.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>

    <link rel="stylesheet" href="/website/assets/css/custom.css">
  </head>
  <body class="home page custom-background top-navbar">
    <header id="banner" class="topnavbar navbar navbar-fixed-top" role="banner">
        <div class="navbar-inner">
            <div class="container">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <a class="brand" href="/website/">
                    <img id="site-logo" src="/website/assets/img/exceptionless-logo1.png" alt="Exceptionless - .NET Exception Reporting">
                </a>
                <nav id="nav-main" class="nav-main nav-collapse collapse" role="navigation">
                    <ul id="menu-primary-navigation" class="nav pull-right"><li class="menu-tour"><a href="/website/tour/">Tour</a></li>
                        <li class="menu-why"><a href="/website/why/">Why?</a></li>
                        <li class="menu-pricing"><a href="/website/pricing/">Pricing</a></li>
                        <li class="menu-news"><a href="/website/news/">News</a></li>
                        <li class="menu-help"><a href="/website/docs/">Docs</a></li>
                        <li class="menu-log-in"><a href="https://be.exceptionless.io">Log In</a></li>
                        <li class="menu-sign-up"><a href="https://be.exceptionless.io/signup?domain=www.codesmithtools.com&amp;type=organic">Sign Up</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div id="megaDrop" class="container-fluid top-megamenu"><div class="container"><div class="row"></div></div></div>
    </header>

    
      
<div class="page-header margin-top">
  <h1>News</h1>
</div>

<div id="wrap" class="container" role="document">
  <div id="content" class="row-fluid">
    <div id="main" class="span12" role="main">
      
        <article class="post type-post status-publish format-standard hentry category-uncategorized tag-net tag-updates">
          <header>
            <h1 class="entry-title">Session Heartbeats No Longer Count Towards Plan Limits</h1>
          </header>
          <div class="entry-content">
            <p><img src="/website/assets/img/news/session-tracking-revised.png" alt="session-tracking-revised">That's right! We've re-imagined&nbsp;how session heartbeats and session end events should work on the back end and were able to make them much more efficient, allowing us to stop counting them toward user plan limits!</p>
<p>This blog post explains our original goals and implementation of these session events, and how we were able to retain the same functionality of the feature while limiting resource usage.</p>
<p>Our hope is that this will obviously make our users happy, but also that all the developers out there can benefit from our process and solution.<!--more--></p>
<h2>Genesis: Exceptionless Session Tracking</h2>
<p>In the beginning, we set out to create a sessions feature that allowed our users to submit a session start event and the session would be automatically updated by sending a session heartbeat event, as well as a session end event, respectively.</p>
<p>These session heartbeats and session end events were meant to be&nbsp;session markers to show that a user was active or a session had ended.</p>
<p>We wanted to <strong>leverage our existing infrastructure,</strong> and the easiest way to do so&nbsp;was to introduce new event types that we recognized. This meant that these events went through the client side plugins (extra work) and server side processing. As such, there was <strong>no way to tell these events apart from any other event</strong>.</p>
<p>And because of that, they counted against user plan&nbsp;limits.</p>
<h2>Noise</h2>
<p>After releasing the sessions feature, <strong>it didn't take us long to notice that the heartbeats were noise</strong>. However, we knew that users wanted to see what their customers or users were doing while being active throughout the session, so we didn't remove them.</p>
<p>We knew they were counting towards plan limits, causing some users to reach theirs quickly, and we knew they were adding noise, thus limiting the feature's&nbsp;value, but we also wanted to keep the feature alive because of the <em>potential</em> value offered. So, we had to react and make the entire feature more feasible, streamlined, and cheap.</p>
<h2>Back to the Drawing Board</h2>
<p>We did some thinking (and coding), trying to determine the best way we could <strong>provide end users with a great session tracking feature without over-taxing our system</strong> in the process, and we were able to come up with a solution!</p>
<p>So, we created a new GET API endpoint <code>/api/v2/events/session/heartbeat</code>&nbsp;(<a href="https://api.exceptionless.io/docs/index.html#!/Event/Event_RecordHeartbeatAsync">api source</a>) that takes a session id or user id and a flag if the session is closed. This API endpoint then sets a unique session cache key with the current time.</p>
<p>Our existing <code>CloseInactiveSessionsJob.cs</code>&nbsp;was already periodically polling for open sessions to check for inactive sessions so it could automatically close them after a period of time if no session end event was sent, so we just updated this job to check for the unique session cache keys (<a href="hhttps://github.com/exceptionless/Exceptionless/blob/master/src/Exceptionless.Core/Jobs/CloseInactiveSessionsJob.cs#L52">source</a>) and get the last time a heartbeat was sent in or see if it was closed. It then takes the appropriate action and updates the session event.</p>
<p>Then we just updated the clients to call this new API endpoint when <code>client.Submit.SessionHeartbeat("id")</code>&nbsp;or <code>client.SubmitSessionEnd("id")</code> is called.</p>
<h2>Efficiency Achieved!</h2>
<p>Our new solution gives us the ability to have clients send us session heartbeat and session end information very efficiently, which lets us provide a great session tracking feature <strong>without adding any additional cost</strong> to our plans!</p>
<p>That's how we like to roll, and we hope you find value from the feature and our run down of the process we went through to get it to our users.</p>
<h3>Don't Forget to Update&nbsp;Your Client</h3>
<p>If you haven't already updated your client, please do so to start taking advantage of the free session events.</p>
<p>And, as always, please let us know if you've got any feedback or questions. We'd love to hear from you!</p>

          </div>
        </article>
            
    </div>
  </div>
</div>

    

    <div id="footer-wrapper">
        <footer id="content-info" class="container" role="contentinfo">
            <div class="row-fluid">
                <div class="span4"><section id="text-2" class="widget-1 widget-first widget widget_text"><div class="widget-inner">			<div class="textwidget"><h3><span class="slash">//</span> Quick Links</h3>
                    <ul class="footer-links clearfix">
                        <li><a href="/website/">Home</a></li>
                        <li><a href="/website/tour/">Tour</a></li>
                        <li><a href="/website/why/">Why?</a></li>
                        <li><a href="/website/pricing/">Pricing</a></li>
                        <li><a href="/website/news/">News</a></li>
                        <li><a href="/website/docs/">Docs</a></li>
                    </ul>
                    <ul class="footer-links clearfix">
                        <li><a href="javascript:Intercom('showNewMessage');">Contact</a></li>
                        <li><a href="https://github.com/exceptionless/Exceptionless" target="_blank" rel="noopener noreferrer">GitHub</a></li>
                        <li><a href="/website/about/">About Us</a></li>
                        <li><a href="/website/terms/">Terms of Use</a></li>
                        <li><a href="/website/privacy/">Privacy Policy</a></li>
                        <li>&nbsp;</li>
                    </ul></div>
                </div></section></div>
                <div class="span3"></div>
                <div class="span4"><section id="text-3" class="widget-1 widget-first widget widget_text"><div class="widget-inner">			<div class="textwidget"><h3><span class="slash">//</span> Stay In Touch</h3>
                    <p>There are real people behind Exceptionless, so if you have a question or suggestion (no matter how small) please get in touch with us:</p>

                    <ul class="social-icons-container">
                        <li>
                            <a href="https://twitter.com/exceptionless" target="_blank" class="social-icon social-icon-twitter" rel="noopener noreferrer">Twitter</a>
                        </li>
                        <li>
                            <a href="https://www.facebook.com/exceptionless" target="_blank" class="social-icon social-icon-facebook" rel="noopener noreferrer">Facebook</a>
                        </li>
                        <li>
                            <a href="https://github.com/exceptionless/Exceptionless" target="_blank" class="social-icon social-icon-github" rel="noopener noreferrer">GitHub</a>
                        </li>
                    </ul></div>
                </div></section></div>
            </div>
        </footer>
        <div class="copyrightContainer">
            <p class="copyright">© 2020 Exceptionless</p>
        </div>
    </div>

    <script src="/website/assets/js/main.js"></script>
    
    <!-- intercom -->
<script>
window.intercomSettings = {
    app_id: "6c0d76e0bec950052459f5cb4b727a949aeabbe1"
};
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/6c0d76e0bec950052459f5cb4b727a949aeabbe1';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<!-- end intercom -->

  

</body></html>