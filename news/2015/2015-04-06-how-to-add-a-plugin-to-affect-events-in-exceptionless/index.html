<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

    <title>How to Add a Plugin to Affect Events in Exceptionless - Exceptionless</title>

    <meta name="description" content="Real-time exception reporting for ASP.NET, Web API, WebForms, WPF, Console, and MVC applications. Includes event organization, notifications, and more.">
    <meta name="robots" content="index,follow">
    <meta name="author" content="[object Object]">

    <link rel="canonical" href="NaN">

    <!-- opengraph -->
    <meta property="og:title" content="How to Add a Plugin to Affect Events in Exceptionless - Exceptionless">
    <meta property="og:type" content="article">
    <meta property="og:url" content="NaN">
    <meta property="og:description" content="Real-time exception reporting for ASP.NET, Web API, WebForms, WPF, Console, and MVC applications. Includes event organization, notifications, and more.">
    <meta property="og:image" content="undefined/undefined/undefined">
    <!-- end opengraph -->

    <!-- twitter -->
    <meta name="twitter:card" content="summary"><meta name="twitter:site" content="@Exceptionless">
    <meta name="twitter:url" content="NaN">
    <meta name="twitter:title" content="How to Add a Plugin to Affect Events in Exceptionless - Exceptionless">
    <meta name="twitter:description" content="Real-time exception reporting for ASP.NET, Web API, WebForms, WPF, Console, and MVC applications. Includes event organization, notifications, and more.">
    <meta name="twitter:image" content="undefined/undefined/undefined">
    <!-- end twitter -->

    <!-- google tag manager -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-433340-8"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-433340-8');
    </script>
    <!-- end google tag manager -->

    <link rel="alternate" href="/website/feed.xml" type="application/atom+xml" title="Exceptionless">
    <link rel="alternate" href="/website/feed.json" type="application/json" title="Exceptionless">
    <link rel="shortcut icon" href="/website/favicon.ico">

    <link rel="stylesheet" href="/website/assets/cyclone-slider-pro/templates/standard/style.css">
    <link rel="stylesheet" href="/website/assets/css/theme.css">
    <link rel="stylesheet" href="/website/assets/css/responsive.css">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,300,400,600" rel="stylesheet">

    <link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <link href="/website/assets/css/prism.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>

    <link rel="stylesheet" href="/website/assets/css/custom.css">
  </head>
  <body class="home page custom-background top-navbar">
    <header id="banner" class="topnavbar navbar navbar-fixed-top" role="banner">
        <div class="navbar-inner">
            <div class="container">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <a class="brand" href="/website/">
                    <img id="site-logo" src="/website/assets/img/exceptionless-logo1.png" alt="Exceptionless - .NET Exception Reporting">
                </a>
                <nav id="nav-main" class="nav-main nav-collapse collapse" role="navigation">
                    <ul id="menu-primary-navigation" class="nav pull-right"><li class="menu-tour"><a href="/website/tour/">Tour</a></li>
                        <li class="menu-why"><a href="/website/why/">Why?</a></li>
                        <li class="menu-pricing"><a href="/website/pricing/">Pricing</a></li>
                        <li class="menu-news"><a href="/website/news/">News</a></li>
                        <li class="menu-help"><a href="/website/docs/">Docs</a></li>
                        <li class="menu-log-in"><a href="https://be.exceptionless.io">Log In</a></li>
                        <li class="menu-sign-up"><a href="https://be.exceptionless.io/signup?domain=www.codesmithtools.com&amp;type=organic">Sign Up</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div id="megaDrop" class="container-fluid top-megamenu"><div class="container"><div class="row"></div></div></div>
    </header>

    
      
<div class="page-header margin-top">
  <h1>News</h1>
</div>

<div id="wrap" class="container" role="document">
  <div id="content" class="row-fluid">
    <div id="main" class="span12" role="main">
      
        <article class="post type-post status-publish format-standard hentry category-uncategorized tag-net tag-updates">
          <header>
            <h1 class="entry-title">How to Add a Plugin to Affect Events in Exceptionless</h1>
          </header>
          <div class="entry-content">
            <p><img src="/website/assets/img/news/plugins-code-featured1.jpg" alt="Exceptionless Plugins">A plugin is a client-side addin that is run every time you submit an event.</p>
<p>Plugins can be used to add or remove data from&nbsp;an event, or even allow you to cancel an event submission.</p>
<p>Each client-specific implementation registers a plugin to provide client-specific information like request info, environmental info, etc. These abilities make plugins very powerful.</p>
<p>Let's take a more in-depth look at Exceptionless Plugins and how they are used.</p>
<!--more-->
<h2>Pre-Reqs</h2>
<p>First,&nbsp;we are assuming that you have already created an account and installed and <a title="Configure Exceptionless" href="/website/docs/clients/dotnet/configuration/" target="_blank">configured</a> the latest version of the Exceptionless client (plugins require client v3 - released 4/6/2015). If you are still using the 1.x client, you will need to <a title="Upgrade Exceptionless Client" href="/website/docs/self-hosting/upgrading-self-hosted-instance/" target="_blank">upgrade</a> to use plugins.&nbsp; Please contact support via an in-app support message or our <a title="Contact Exceptionless" href="/website/contact/" target="_blank">contact page</a> if you have any questions or need assistance in this area.</p>
<h2>Creating a New Plugin</h2>
<p>Before we create our first plugin, it’s important to keep in mind that <strong>each plugin will run every time an event is submitted</strong>. As such, you should ensure your plugins are fast and not super resource-intensive so your app remains as quick as possible.</p>
<p>To&nbsp;create a plugin, you have to specify a System.Action<eventplugincontext>, or create a class that derives from&nbsp;<a title="Exceptionless IEventPlugin" href="https://github.com/exceptionless/Exceptionless.Net/blob/master/src/Exceptionless/Plugins/IEventPlugin.cs" target="_blank">IEventPlugin</a>.</eventplugincontext></p>
<p>Every plugin is passed an <a title="Exceptionless Plugin Contect" href="https://github.com/exceptionless/Exceptionless.Net/blob/master/src/Exceptionless/Plugins/EventPluginContext.cs" target="_blank">EventPluginContext</a>, which contains all the valuable contextual information that your plugin may need via the following properties:</p>
<ul>
<li>**Client
** The ExceptionlessClient that created the event.</li>
<li>**Event
** The target event.</li>
<li>**ContextData
** Allows plugins to access additional contextual data to allow them to add additional data to events.</li>
<li>**Log
** An ExceptionlessLog implementation that lets you write to the internal logger. This internal logger is used only when debugging the client.</li>
<li>****Resolver
**** The ExceptionlessClient`s dependency resolver. This is useful for resolving other dependencies at runtime that were not requested via constructor injection.</li>
</ul>
<h3>Exceptionless Plugin Example - Add System Uptime to Feature Usages</h3>
<p>The following system uptime plugin derives from IEventPlugin and places the system uptime into every feature usage event as extended data when the plugin’s Run(context) method is called.</p>
<pre><code class="language-cs hljs language-csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Diagnostics;
<span class="hljs-keyword">using</span> Exceptionless.Plugins;
<span class="hljs-keyword">using</span> Exceptionless.Models;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">Exceptionless.SampleConsole.Plugins</span> {
    [<span class="hljs-meta">Priority(100)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SystemUptimePlugin</span> : <span class="hljs-title">IEventPlugin</span> {
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Run</span>(<span class="hljs-params">EventPluginContext context</span>)</span> {
            <span class="hljs-comment">// Only update feature usage events.</span>
            <span class="hljs-keyword">if</span> (context.Event.Type != Event.KnownTypes.FeatureUsage)
                <span class="hljs-keyword">return</span>;

            <span class="hljs-comment">// Get the system uptime</span>
            <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> pc = <span class="hljs-keyword">new</span> PerformanceCounter(<span class="hljs-string">"System"</span>, <span class="hljs-string">"System Up Time"</span>)) {
                pc.NextValue();

                <span class="hljs-keyword">var</span> uptime = TimeSpan.FromSeconds(pc.NextValue());

                <span class="hljs-comment">// Store the system uptime as an extended property.</span>
                context.Event.SetProperty(<span class="hljs-string">"System Uptime"</span>, String.Format(<span class="hljs-string">"{0} Days {1} Hours {2} Minutes {3} Seconds"</span>, uptime.Days, uptime.Hours, uptime.Minutes, uptime.Seconds));
            }
        }
    }
}
</code></pre>
<p><strong>Output in Exceptionless:</strong></p>
<h4><a href="/website/assets/exceptionless-plugin-system-uptime.png"><img src="/website/assets/img/news/exceptionless-plugin-system-uptime.png" alt="Exceptionless Plugin System Uptime"></a></h4>
<p><em>Note:</em>&nbsp;We kept the formatting of the uptime simple for the sake of this example, but we recommend&nbsp;using our <a title="Exceptionless Date Time Extensions Library" href="https://github.com/exceptionless/Exceptionless.DateTimeExtensions" target="_blank">open source&nbsp;DateTimeExtensions library</a> if you wish to format it in a really pretty manner.</p>
<h4>Plugin Priority</h4>
<p>You might have noticed that there is a priority attribute with a value of 100. The priority of a plugin determines the order that the plugin will run in (runs in order of lowest to highest, and then by order added). All plugins that ship as part of the client start with a priority of 10 and increment by multiples of 10. If you want your addin to run first, give it a low priority (e.g., 0, 1, 2, 3, 4, 5). If you want it to run last, give it a high priority (&gt;100). By default, if you don’t specify a priority, 0 will be used.</p>
<p>To make sure your plugin runs first (if required), you can inspect the configuration's plugin property in Visual Studio while debugging.</p>
<pre><code class="language-cs hljs language-csharp"><span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> plugin <span class="hljs-keyword">in</span> Exceptionless.ExceptionlessClient.Default.Configuration.Plugins)
    Console.WriteLine(plugin);
</code></pre>
<p><img src="/website/assets/img/news/exceptionless-plugin-priority.png" alt="Exceptionless Plugin Priority"></p>
<h2>Adding the Plugin to Your App</h2>
<p>Now that we've created the plugin, we’ll add it when our application starts up by calling one of the Exceptionless.ExceptionlessClient.Default.Configuration.AddPlugin() overloads.</p>
<p>In most cases, we use the following overload to register plugins:</p>
<pre><code class="language-cs hljs language-csharp"><span class="hljs-keyword">using</span> Exceptionless;
ExceptionlessClient.Default.Configuration.AddPlugin&lt;SystemUptimePlugin&gt;();
</code></pre>
<p>When you add a plugin by specifying the type, we inspect the type and try to find a PriorityAttribute. If we can’t find one, the default value of 0 will be used.</p>
<p>You can also add a plugin by passing a System.Action<eventplugincontext> to AddPlugin.
<em>Please note that we are specifying a key when adding the action plugin so we can remove it later. If you are not going to be removing your plugin, then you can omit the first argument.</em></eventplugincontext></p>
<p><strong>We pass AddPlugin three arguments:</strong></p>
<ul>
<li><strong>A unique plugin key</strong> (which can be used to remove the plugin later)</li>
<li><strong>Priority</strong></li>
<li><strong>An action</strong> that contains all of our logic to add the system uptime (or whatever your plugin does).</li>
</ul>
<pre><code class="language-cs hljs language-csharp"><span class="hljs-keyword">using</span> Exceptionless;
ExceptionlessClient.Default.Configuration.AddPlugin(<span class="hljs-string">"system-uptime"</span>, <span class="hljs-number">100</span>, context =&gt; {
    <span class="hljs-comment">// Only update feature usage events.</span>
    <span class="hljs-keyword">if</span> (context.Event.Type != Event.KnownTypes.FeatureUsage)
        <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// Get the system uptime</span>
    <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> pc = <span class="hljs-keyword">new</span> PerformanceCounter(<span class="hljs-string">"System"</span>, <span class="hljs-string">"System Up Time"</span>)) {
         pc.NextValue();
         <span class="hljs-keyword">var</span> uptime = TimeSpan.FromSeconds(pc.NextValue());

         <span class="hljs-comment">// Store the system uptime as an extended property.</span>
         context.Event.SetProperty(<span class="hljs-string">"&lt;wbr /&gt;System Uptime"</span>, String.Format(<span class="hljs-string">"{0} Days {1} Hours {2} Minutes {3} Seconds"</span>, uptime.Days, uptime.Hours, uptime.Minutes, uptime.Seconds));

     }
});
</code></pre>
<h2>Removing an Existing Plugin</h2>
<p>To remove a previously added plugin, you need to call one of the Exceptionless.ExceptionlessClient.Default.Configuration.RemovePlugin overloads.</p>
<pre><code class="language-cs hljs language-csharp"><span class="hljs-keyword">using</span> Exceptionless;
ExceptionlessClient.Default.Configuration.RemovePlugin&lt;SystemUptimePlugin&gt;();
</code></pre>
<p>If you registered your plugin via an action, you will need to remove the plugin with the key it was added with.</p>
<pre><code class="language-cs hljs language-csharp"><span class="hljs-keyword">using</span> Exceptionless;
ExceptionlessClient.Default.Configuration.RemovePlugin(<span class="hljs-string">"system-uptime"</span>);
</code></pre>
<h2>How Can&nbsp;You Use Plugins?</h2>
<p>Can you think of ways that plugins can help your app? Are you already building some? Let us know what they are and how they help! Eventually, we plan on building a library of useful and common plugins that other developers can easily implement. The more help we've got, the faster that library will grow!</p>

          </div>
        </article>
            
    </div>
  </div>
</div>

    

    <div id="footer-wrapper">
        <footer id="content-info" class="container" role="contentinfo">
            <div class="row-fluid">
                <div class="span4"><section id="text-2" class="widget-1 widget-first widget widget_text"><div class="widget-inner">			<div class="textwidget"><h3><span class="slash">//</span> Quick Links</h3>
                    <ul class="footer-links clearfix">
                        <li><a href="/website/">Home</a></li>
                        <li><a href="/website/tour/">Tour</a></li>
                        <li><a href="/website/why/">Why?</a></li>
                        <li><a href="/website/pricing/">Pricing</a></li>
                        <li><a href="/website/news/">News</a></li>
                        <li><a href="/website/docs/">Docs</a></li>
                    </ul>
                    <ul class="footer-links clearfix">
                        <li><a href="javascript:Intercom('showNewMessage');">Contact</a></li>
                        <li><a href="https://github.com/exceptionless/Exceptionless" target="_blank" rel="noopener noreferrer">GitHub</a></li>
                        <li><a href="/website/about/">About Us</a></li>
                        <li><a href="/website/terms/">Terms of Use</a></li>
                        <li><a href="/website/privacy/">Privacy Policy</a></li>
                        <li>&nbsp;</li>
                    </ul></div>
                </div></section></div>
                <div class="span3"></div>
                <div class="span4"><section id="text-3" class="widget-1 widget-first widget widget_text"><div class="widget-inner">			<div class="textwidget"><h3><span class="slash">//</span> Stay In Touch</h3>
                    <p>There are real people behind Exceptionless, so if you have a question or suggestion (no matter how small) please get in touch with us:</p>

                    <ul class="social-icons-container">
                        <li>
                            <a href="https://twitter.com/exceptionless" target="_blank" class="social-icon social-icon-twitter" rel="noopener noreferrer">Twitter</a>
                        </li>
                        <li>
                            <a href="https://www.facebook.com/exceptionless" target="_blank" class="social-icon social-icon-facebook" rel="noopener noreferrer">Facebook</a>
                        </li>
                        <li>
                            <a href="https://github.com/exceptionless/Exceptionless" target="_blank" class="social-icon social-icon-github" rel="noopener noreferrer">GitHub</a>
                        </li>
                    </ul></div>
                </div></section></div>
            </div>
        </footer>
        <div class="copyrightContainer">
            <p class="copyright">© 2020 Exceptionless</p>
        </div>
    </div>

    <script src="/website/assets/js/main.js"></script>
    
    <!-- intercom -->
<script>
window.intercomSettings = {
    app_id: "6c0d76e0bec950052459f5cb4b727a949aeabbe1"
};
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/6c0d76e0bec950052459f5cb4b727a949aeabbe1';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<!-- end intercom -->

  

</body></html>